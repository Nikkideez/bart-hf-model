  0%|                                                                                                                                                                                                                                         | 0/316 [00:00<?, ?it/s]You're using a BartTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  2%|███▌                                                                                                                                                                                                                             | 5/316 [00:01<01:10,  4.41it/s]Traceback (most recent call last):
  File "/home/nikx/Documents/Projects/capstone/bart/model/train-model.py", line 66, in <module>
    trainer.train()
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/transformers/trainer.py", line 1553, in train
    return inner_training_loop(
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/transformers/trainer.py", line 1914, in _inner_training_loop
    self.optimizer.step()
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/accelerate/optimizer.py", line 132, in step
    self.scaler.step(self.optimizer, closure)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py", line 416, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py", line 315, in _maybe_opt_step
    retval = optimizer.step(*args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/accelerate/optimizer.py", line 185, in patched_step
    return method(*args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/lr_scheduler.py", line 68, in wrapper
    return wrapped(*args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/optimizer.py", line 373, in wrapper
    out = func(*args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/adamw.py", line 184, in step
    adamw(
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/adamw.py", line 335, in adamw
    func(
  File "/home/nikx/capstone/bart-env/lib/python3.9/site-packages/torch/optim/adamw.py", line 599, in _multi_tensor_adamw
    exp_avg_sq_sqrt = torch._foreach_sqrt(device_exp_avg_sqs)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacty of 7.78 GiB of which 22.69 MiB is free. Process 197163 has 7.35 GiB memory in use. Of the allocated memory 6.99 GiB is allocated by PyTorch, and 240.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
{'loss': 7.0187, 'learning_rate': 1.624749612285061e-05, 'epoch': 0.01}
{'loss': 7.189, 'learning_rate': 1.624749612285061e-05, 'epoch': 0.01}
{'loss': 7.0956, 'learning_rate': 1.624749612285061e-05, 'epoch': 0.02}
{'loss': 7.1362, 'learning_rate': 1.624749612285061e-05, 'epoch': 0.03}
{'loss': 6.5993, 'learning_rate': 1.624749612285061e-05, 'epoch': 0.03}